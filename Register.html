<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"
      integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>

    <link rel="stylesheet" href="style.css" />
    <title>Register</title>
  </head>
  <body>
    <h2>Sign Up</h2>
    <form id="registrationForm">
      <div class="input-container">
        <input id="firstName" type="text" placeholder="First Name" />
      </div>
      <div class="input-container">
        <input id="lastName" type="text" placeholder="Last Name" />
      </div>
      
      <div class="input-container">
        <input id="city" type="text" placeholder="City" />
      </div>
      <div class="input-container">
        <input id="state" type="text" placeholder="State" />
      </div>
      <div class="input-container">
        <input id="country" type="text" placeholder="Country" />
      </div>
      <div class="input-container">
        <input id="contactNumber" type="number" placeholder="Contact Number" />
      </div>
      <div class="input-container">
        <input id="userName" type="text" placeholder="User Name" required />
      </div>
      <div class="input-container">
        <input id="password" type="password" placeholder="Password" required />
      </div>
      <div class="input-container">
        <input type="submit" class="btn-submit" value="Register" />
      </div>
      <div>
        <p>Already have an account? <a href="Login.html">Login Here</a></p>
      </div>
    </form>
    <script>
      $(document).ready(function () {
        $("#registrationForm").on("submit", function (event) {
          event.preventDefault(); // Prevent page reload

          // Collect form data into an object
          const newUser = {
            firstName: $("#firstName").val(),
            lastName: $("#lastName").val(),
            city: $("#city").val(),
            state: $("#state").val(),
            country: $("#country").val(),
            contactNumber: $("#contactNumber").val(),
            userName: $("#userName").val(),
            password: $("#password").val(),
          };

          // Function to get the value of a cookie by name
          function getCookie(name) {
            const value = `; ${document.cookie}`;
            const parts = value.split(`; ${name}=`);
            if (parts.length === 2) return parts.pop().split(";").shift();
          }

          // Retrieve the formData cookie (if it exists)
          const existingUsersCookie = getCookie("formData");
          //console.log(existingUsersCookie);
          

          // Initialize an empty array to hold users
          let users = [];

          if (existingUsersCookie) {
            // Parse the existing cookie if it exists
            users = JSON.parse(existingUsersCookie);
          }

          // Add the new user to the array
          users.push(newUser);

          // Convert the updated array to a JSON string
          const updatedUsersString = JSON.stringify(users);

          // Store the updated array in the cookie
          document.cookie = `formData=${updatedUsersString}; path=/;`;

          // Redirect to login page
          window.location.href = "Login.html";
        });
      });
    </script>
  </body>
</html>
